select r."RequestStatus" , count(r."RequestStatus")
from "Requests" r 
group by "RequestStatus" 

select r."RequestStatus",
avg(r."ApprovedAmount") as "ApprovedAmount", 
avg(r."LendedAmount") as "LendedAmount",
avg(r."RepaidAmount") as "RepaidAmount"
from "Requests" r 
group by "RequestStatus" 

select r."Product", count(r."Product")
from "Requests" r 
group by "Product" 

select r."Product",
avg(r."ApprovedAmount") as "ApprovedAmount", 
avg(r."LendedAmount") as "LendedAmount",
avg(r."RepaidAmount") as "RepaidAmount"
from "Requests" r 
group by "Product" 

select r."Product", r."AddressRegion", count(r."RequestId")
from "Requests" r 
group by r."Product", r."AddressRegion" 
order by r."Product", r."AddressRegion" 

select r."Product" , 
date_part('year', r."ApplicationDate") as "year",
r."RequestStatus" as "requestStatus",
count(date_part('year', r."ApplicationDate")) as "count"
from "Requests" r 
group by r."Product","year", "requestStatus"
order by r."Product","year", "requestStatus"

select r."Product" , 
date_part('year', r."ApplicationDate") as "year",
date_part('month', r."ApplicationDate") as "month",
r."RequestStatus" as "requestStatus",
count(date_part('year', r."ApplicationDate")) as "count"
from "Requests" r 
group by r."Product","requestStatus", "year", "month"
order by r."Product","requestStatus", "year", "month"


select r."AddressRegion", count(r."AddressRegion")
from "Requests" r 
group by "AddressRegion" 

select avg(r."ApprovedAmount") as "ApprovedAmount" 
from "Requests" r 

select avg(r."LendedAmount") as "LendedAmount" 
from "Requests" r 

select avg(r."RepaidAmount") as "RepaidAmount" 
from "Requests" r 

select count(CASE WHEN r."IsNewClient" THEN 1 END) as "newClientCount", count(r."RequestId")
from "Requests" r 

select count(CASE WHEN r."IsPaidOff" THEN 1 END) as "isRefinancedCount", count(r."RequestId")
from "Requests" r

select count(CASE WHEN r."IsRefinance" THEN 1 END) as "isRefinancedCount", count(r."RequestId")
from "Requests" r 

select count(CASE WHEN r."IsRefinanced" THEN 1 END) as "isRefinancedCount", count(r."RequestId")
from "Requests" r





